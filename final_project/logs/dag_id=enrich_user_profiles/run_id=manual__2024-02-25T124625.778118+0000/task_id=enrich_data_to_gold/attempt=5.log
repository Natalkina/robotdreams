[2024-02-25T13:14:21.305+0000] {taskinstance.py:1957} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: enrich_user_profiles.enrich_data_to_gold manual__2024-02-25T12:46:25.778118+00:00 [queued]>
[2024-02-25T13:14:21.313+0000] {taskinstance.py:1957} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: enrich_user_profiles.enrich_data_to_gold manual__2024-02-25T12:46:25.778118+00:00 [queued]>
[2024-02-25T13:14:21.313+0000] {taskinstance.py:2171} INFO - Starting attempt 5 of 5
[2024-02-25T13:14:21.324+0000] {taskinstance.py:2192} INFO - Executing <Task(BigQueryInsertJobOperator): enrich_data_to_gold> on 2024-02-25 12:46:25.778118+00:00
[2024-02-25T13:14:21.329+0000] {standard_task_runner.py:60} INFO - Started process 2379 to run task
[2024-02-25T13:14:21.331+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'enrich_user_profiles', 'enrich_data_to_gold', 'manual__2024-02-25T12:46:25.778118+00:00', '--job-id', '240', '--raw', '--subdir', 'DAGS_FOLDER/enrich_user_profiles.py', '--cfg-path', '/tmp/tmp40nz2oiq']
[2024-02-25T13:14:21.332+0000] {standard_task_runner.py:88} INFO - Job 240: Subtask enrich_data_to_gold
[2024-02-25T13:14:21.372+0000] {task_command.py:423} INFO - Running <TaskInstance: enrich_user_profiles.enrich_data_to_gold manual__2024-02-25T12:46:25.778118+00:00 [running]> on host 9e4f31030bba
[2024-02-25T13:14:21.429+0000] {taskinstance.py:2481} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='enrich_user_profiles' AIRFLOW_CTX_TASK_ID='enrich_data_to_gold' AIRFLOW_CTX_EXECUTION_DATE='2024-02-25T12:46:25.778118+00:00' AIRFLOW_CTX_TRY_NUMBER='5' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-02-25T12:46:25.778118+00:00'
[2024-02-25T13:14:21.438+0000] {connection.py:234} WARNING - Connection schemes (type: google_cloud_platform) shall not contain '_' according to RFC3986.
[2024-02-25T13:14:21.442+0000] {base.py:83} INFO - Using connection ID 'google_cloud_default' for task execution.
[2024-02-25T13:14:21.443+0000] {bigquery.py:2806} INFO - Executing: {'query': {'query': "\n                         MERGE INTO `de-07-natalia-sokil.gold.user_profiles_enriched` AS TARGET\n        USING (\n            SELECT\n                c.client_id,\n                IFNULL(c.first_name, SPLIT(u.full_name, ' ')[OFFSET(0)]) AS first_name,\n                IFNULL(c.last_name, SPLIT(u.full_name, ' ')[SAFE_OFFSET(1)]) AS last_name,\n                c.email,\n                c.registration_date,\n                IFNULL(c.state, u.state) AS state,\n                u.birth_date,\n                u.phone_number\n            FROM `de-07-natalia-sokil.silver.customers` c\n            JOIN `de-07-natalia-sokil.silver.user_profiles` u\n            ON c.email = u.email\n        ) AS SOURCE\n        ON TARGET.email = SOURCE.email\n        \n        WHEN MATCHED THEN\n            UPDATE SET\n                TARGET.client_id = SOURCE.client_id,\n                TARGET.first_name = SOURCE.first_name,\n                TARGET.last_name = SOURCE.last_name,\n                TARGET.registration_date = SOURCE.registration_date,\n                TARGET.state = SOURCE.state,\n                TARGET.birth_date = SOURCE.birth_date,\n                TARGET.phone_number = SOURCE.phone_number\n                \n        WHEN NOT MATCHED THEN\n            INSERT (client_id, first_name, last_name, email, registration_date, state, birth_date, phone_number)\n            VALUES (SOURCE.client_id, SOURCE.first_name, SOURCE.last_name, SOURCE.email, SOURCE.registration_date, SOURCE.state, SOURCE.birth_date, SOURCE.phone_number);\n                    ", 'useLegacySql': False}}'
[2024-02-25T13:14:21.480+0000] {bigquery.py:1596} INFO - Inserting job ***_enrich_user_profiles_enrich_data_to_gold_2024_02_25T12_46_25_778118_00_00_1408631e1c04c449e9b5768c72a7e6e6
[2024-02-25T13:14:24.514+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=enrich_user_profiles, task_id=enrich_data_to_gold, execution_date=20240225T124625, start_date=20240225T131421, end_date=20240225T131424
[2024-02-25T13:14:24.555+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2024-02-25T13:14:24.568+0000] {taskinstance.py:3281} INFO - 0 downstream tasks scheduled from follow-on schedule check
